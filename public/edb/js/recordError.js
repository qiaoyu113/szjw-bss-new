senvenProvide("moorCall.recordError");var errorArr=[],recordErrorFun=null;moorCall.recordError.sendActionToPbx=function(){recordErrorFun=recordErrorFun||window.setInterval(function(){var r,e;0<errorArr.length?(r=account.url,e={Command:"Action",Action:"sykjRecordError",Account:account.accountId,ActionID:"sykjRecordError"+Math.random(),PBX:account.PBX,SessionID:account.sessionId,ErrorTime:errorArr[0].errorTime},errorArr[0]&&errorArr[0].eventJson&&(e.EventJson=errorArr[0].eventJson),errorArr[0]&&errorArr[0].catchRecord&&(e.CatchRecord=errorArr[0].catchRecord),errorArr[0]&&errorArr[0].type&&(e.type=errorArr[0].type),m7$.ajax({url:r,data:{json:JSON.stringify(e)},jsonp:"callbackName",async:!0,timeout:15e3,dataType:"jsonp",success:function(r,e){},error:function(r,e){}}),errorArr.splice(0,1)):(window.clearInterval(recordErrorFun),recordErrorFun=null)},5e3)},moorCall.recordError.dataHandle=function(r){var e,o,n;r.flag&&"pageError"==r.flag?(o=r.error.stack.indexOf("at ",r.error.stack.indexOf("at ")+1),n=(e=r.error.stack.substring(0,o)).indexOf("/js/"),o=e.indexOf("at "),n=e.substring(n+1,e.length),n=(n=e.substring(0,o)+n).replace(/\ +/g,"").replace(/[\r\n]/g,""),n={eventJson:{ChannelStatus:r.errorItem.ChannelStatus,ChannelType:r.errorItem.ChannelType,Event:r.errorItem.Event,Exten:r.errorItem.Exten,ExtenType:r.errorItem.ExtenType},catchRecord:{str:n},errorTime:r.errorTime},errorArr.push(n)):errorArr.push(r)},moorCall.recordError.getCurrentTime=function(){var r=new Date,e=r.getFullYear(),o=r.getMonth()+1,n=r.getDate(),t=r.getHours(),c=r.getMinutes(),r=r.getSeconds(),e=e+"-";return o<10&&(e+="0"),e+=o+"-",n<10&&(e+="0"),e+=n+" ",t<10&&(e+="0"),e+=t+":",c<10&&(e+="0"),e+=c+":",r<10&&(e+="0"),e+=r};